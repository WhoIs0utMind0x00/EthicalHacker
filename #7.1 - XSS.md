# Vulnerabilidades de Secuencias de Comandos entre Sitios (XSS)
Las vulnerabilidades de **_secuencias de comandos entre sitios (XSS)_**, que se han convertido en una de las vulnerabilidades de aplicaciones web más comunes, se logran mediante los siguientes tipos de ataques:<br>
- XSS reflejado
- XSS almacenado (persistente)
- XSS basado en DOM

La explotación exitosa podría resultar en la instalación o ejecución de código malicioso, compromiso de cuentas, secuestro de cookies de sesión, revelación o modificación de archivos locales, o redirección del sitio.<br>

Normalmente, las vulnerabilidades de XSS se encuentran en lo siguiente:<br>
- Campos de búsqueda que devuelven una cadena de búsqueda al usuario
- Encabezados HTTP
- Campos de entrada que repiten los datos del usuario
- Mensajes de error que devuelven texto proporcionado por el usuario
- Campos ocultos que pueden incluir datos de entrada del usuario
- Aplicaciones (o sitios web) que muestran datos proporcionados por el usuario

El siguiente ejemplo muestra una prueba de XSS que se puede realizar desde la barra de direcciones del navegador:<br>

```
    javascript:alert("Omar_s_XSS test");
    javascript:alert(document.cookie);
```

El siguiente ejemplo muestra una prueba XSS que se puede realizar en un campo de entrada de usuario en un formulario web:<br>

```JavaScript
    <script>alert("XSS Test")</script>
```

# Ataques XSS Reflejados
Los ataques XSS reflejados se producen cuando una aplicación web vulnerable inyecta código o scripts maliciosos mediante cualquier método que dé una respueste como parte de una solicitud HTTP válida. Un ejemplo de ataque XSS reflejado es el de persuadir a un usuario de que siga un enlace malicioso a un servidor vulnerable que inyecta el código malicioso en el navegador del usuario. Esto hace que el navegador ejecute el código o la secuencia de comandos (script). En este caso, el servidor vulnerable suele ser un sitio conocido o de confianza.<br>
### Pasos de un ataque XSS reflejado
- __Paso 1__. El atacante encuentra una vulnerabilidad en el servidor web.
- __Paso 2__. El atacante envía un enlace malicioso a la víctima.
- __Paso 3__. La víctima hace clic en el enlace malicioso y el ataque se envía al servidor vulnerable.
- __Paso 4__. El ataque se refleja hacia la víctima y se ejecuta.
- __Paso 5__. La víctima envía información (dependiendo del ataque) al atacante.<br>

# Ataques XSS Almacenados
Los ataques XSS almacenados o persistentes se producen cuando un código malicioso o un script se almacenan permanentemente en un servidor vulnerable o malicioso mediante una base de datos. Estos ataques generalmente se llevan a cabo en sitios web que alojan publicaciones en blogs, foros web y otros métodos de almacenamiento permanente. Un ejemplo de un ataque XSS almacenado es un usuario que solicita la información almacenada del servidor vulnerable o malicioso, lo que provoca la inyección del script malicioso solicitado en el navegador de la víctima. En este tipo de ataque, el servidor vulnerable suele ser un sitio conocido o de confianza.<br>

_Ataque XSS Almacenado en un Formulario Web_<br>

<img src="Imagenes/XSS_Almacenado.png" width="50%" height="50%" style="border-radius:10px;"><br>

Despues de que el usuario hagta clic en _Sign Guestbook_, aparecerá el cuadro de diálogo que se muestra en la imagen. El ataque persiste porque incluso si el usuario navega fuera de la página y regresa a esa misma página, el cuadro de diálogo sigue apareciendo.<br>

_Ataque XSS Persistente_<br>

<img src="Imagenes/XSS_Persistente.png" width="50%" height="50%" style="border-radius:10px;">

En este ejemplo, el mensaje del cuadro de diálogo es "Omar was here!" Sin embargo, en un ataque real, un atacante puede presentar a los usuarios un texto que los convenza de realizar una acción específica, como "su contraseña ha vencido" o "vuelva a iniciar sesión". El objetivo del atacante sería redirigir al usuario a otro sitio para robar sus credenciales cuando el usuario intenta cambiar la contraseña o iniciar sesión una vez más en la aplicación falsa.<br>

El Modelo de Objeto de Documento (DOM) es una interfaz de programación de aplicaciones multiplataforma e independiente del lenguaje que trata un documento HTML, XHTML o XML como una estructura en forma de árbol. Los ataques basados en DOM suelen ser ataques XSS reflejados que se activan mediante el envío de un enlace con entradas que se reflejan en el navegador web. En los ataques XSS basados en DOMm la carga útil nunca se envía al servidor. En cambio, la carga útil solo la procesa el cliente web (navegador).<br>

En un ataque XSS basado en DOM, el atacante envía una URL maliciosa a la víctima, y, después de que la víctima haga clic en el enlace, el atacante puede cargar un sitio web malicioso o un sitio que tenga un controlador de ruta DOM vulnerable. Una vez que el navegador representa el sitio vulnerable, la carga útil ejecuta el ataque en el contexto del usuario en este sitio.<br>

Uno de los efectos de cualquier tipo de ataque XSS es que la víctima generalmente no se da cuenta de que se ha producido un ataque.<br>