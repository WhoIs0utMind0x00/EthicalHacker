# 8.2.5 - Cómo cubrir tus huellas
Después de poner en riesgo un sistema durante una prueba de penetración, siempre debe cubrir sus rastros para evitar la detección suprimiendo registros (cuando sea posible), eliminando cuentas de usuario que podrían haberse creado en el sistema y eliminando cualquier archivo que se haya creado. Además, después de completar una participación de prueba de penetración, debe limpiar todos los sistemas. Como mejor práctica, debe analizar estas tareas y documentarlas en el documento de reglas de participación durante la fase previa a la participación. Las siguientes son algunas prácticas recomendadas para tener en cuenta durante el proceso de limpieza:<br>
+ Elimine todas las cuentas de usuario durante la prueba.
+ Elimine todos los archivos, binarios ejecutables, scripts y archivos temporales de los sistemas comprometidos. Puede ser preferible un método de eliminación seguro. La publicación especial 800-88 del NIST, revisión 1: "Pautas para la sanitización de los medios", proporciona orientación para la sanitización de los medios. Esta metodología debe analizarse con su cliente y el propietario de los sistemas afectados.
+ Devuelva los sistemas modificados y su configuración a sus valores y parámetros originales.
+ Elimine todas las puertas traseras, daemons, servicios y rootkits instalados.
+ Elimine todos los datos de clientes de sus sistemas, incluidos los sistemas atacantes y cualquier otro sistema de soporte. Por lo general, debe hacer esto después de crear y entregar el informe de prueba de penetración al cliente.<br>

### Esteganografía
Los atacantes pueden utilizar la esteganografía para la ofuscación, la evasión y para tapar el rastro. **_La esteganografía_** implica ocultar un mensaje o cualquier otro contenido dentro de una imagen o un archivo de video. Para realizar esta tarea, puedes utilizar herramientas como __steghide__. Puede instalar fácilmente esta herramienta en un sistema Linux basado en Debian con el comando `sudo apt install steghide`. El siguiente ejemplo muestra el uso del comando `steghide` y la información de ayuda.<br>
```bash
    ┌──(root㉿Kali)-[~]
    └─# steghide --help
    steghide version 0.5.1

    the first argument must be one of the following:
     embed, --embed             embed data
     extract, --extract        extract data
     info, --info                display information about a cover- or
                               stego-file
     info <filename>          display information about <filename>
     encinfo, --encinfo        display a list of supported encryption
                               algorithms
     version, --version        display version information
     license, --license        display steghide’s license
     help, --help               display this usage information

    embedding options:
     -ef, --embedfile          select file to be embedded
       -ef <filename>          embed the file <filename>
     -cf, --coverfile          select cover-file
       -cf <filename>          embed into the file <filename>
     -p, --passphrase          specify passphrase
       -p <passphrase>         use <passphrase> to embed data
     -sf, --stegofile          select stego file
       -sf <filename>          write result to <filename> instead of
                              cover-file
     -e, --encryption          select encryption parameters
       -e <a>[<m>]|<m>[<a>]   specify an encryption algorithm and/or mode
       -e none                   do not encrypt data before embedding
     -z, --compress            compress data before embedding (default)
       -z <l>                    using level <l> (1 best speed...9 best
                              compression)
     -Z, --dontcompress        do not compress data before embedding
     -K, --nochecksum          do not embed crc32 checksum of embedded data
     -N, --dontembedname       do not embed the name of the original file
     -f, --force                 overwrite existing files
     -q, --quiet                 suppress information messages
     -v, --verbose              display detailed information

    extracting options:
     -sf, --stegofile          select stego file
       -sf <filename>          extract data from <filename>
     -p, --passphrase          specify passphrase
     -p <passphrase>         use <passphrase> to extract data
     -xf, --extractfile        select file name for extracted data
     -xf <filename>           write the extracted data to <filename>
     -f, --force                overwrite existing files
     -q, --quiet                suppress information messages
     -v, --verbose              display detailed information

    options for the info command:
     -p, --passphrase          specify passphrase
       -p <passphrase>         use <passphrase> to get info about
                              embedded data

    To embed emb.txt in cvr.jpg: steghide embed -cf cvr.jpg -ef emb.txt
    To extract embedded data from stg.jpg: steghide extract -sf stg.jpg
```
Veamos un ejemplo de cómo insertar información confidencial y ocultar un mensaje en un archivo de imagen mediante la esteganografía. En el ejemplo, un archivo denominado secret.txt incluye información confidencial (datos de tarjetas de crédito) que se exfiltrará mediante esteganografía.<br>
```bash
    ┌──(kali㉿Kali)-[~]
    └─$ cat secret.txt
    Credit card data:
    4011 5555 5555 5555 5555 exp 08/29 ccv: 123
    4021 6666 7777 8888 9999 exp 02/29 ccv: 321
```
El siguiente ejemplo muestra cómo insertar estos datos confidenciales (secret.txt) en un archivo de imagen (websploit-logo.png) mediante __steghide__.<br>
```bash
    ┌──(kali㉿Kali)-[~]
    └─$ steghide embed -ef secret.txt -cf websploit-logo.jpg
    Enter passphrase: this-is-a-passphrase
    Re-Enter passphrase: this-is-a-passphrase
    embedding "secret.txt" in "websploit-logo.jpg"... done
```
El siguiente ejemplo muestra cómo se recuperan los datos confidenciales de la imagen y se guardan en un archivo (extracted_data.txt):<br>
```bash
    ┌──(kali㉿Kali)-[~]
    └─$ steghide extract -sf websploit-logo.jpg -xf extracted_data.txt
    Enter passphrase: this-is-a-passphrase
    wrote extracted data to "extracted_data.txt".
```
El siguiente ejemplo muestra el contenido del archivo de datos extraído (extracted_data.txt):<br>
```bash
    ┌──(kali㉿Kali)-[~]
    └─$ cat extracted_data.txt
    Credit card data:
    4011 5555 5555 5555 5555 exp 08/29 ccv: 123
    4021 6666 7777 8888 9999 exp 02/29 ccv: 321
```