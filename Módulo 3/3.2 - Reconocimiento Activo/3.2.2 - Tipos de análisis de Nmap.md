# 3.2.2 - Tipos de Análisis de Nmap
Las siguientes secciones cubren algunas de las opciones de escaneos de Nmap más comunes utilizadas para escenarios específicos, incluidas las siguientes:<br>
- Escaneo de conexión TCP (`-sT`)
- Escaneo de UDP (`-sU`)
- Escaneo FIN de TCP (`-sF`)
- Escaneos de detección de host (`-sn`)
- Opciones de tiempo (`-T 0-5`)<br>
<hr>

### Escaneo de conexión TCP (`-sT`)
Un escaneo de conexión TCP realmente utiliza el mecanismo de red del sistema operativo subyacente para establecer una conexión TCP completa con el dispositivo de destino que se está escaneando. Dado que crea una conexión completa, crea más tráfico (y, por lo tanto, tarda más en ejecutarse). Este es el tipo de escaneo predeterminado que se utiliza si no se especifica ningún tipo de escaneo con el comando `nmap`. Sin embargo, generalmente se debe usar solo cuando un escaneo SYN no es una opción, como cuando un usuario que ejecuta el comando `nmap` no tiene privilegios de paquetes sin procesar en el sistema operativo porque muchos de los tipos de escaneo de Nmap dependen sobre la escritura de paquetes sin procesar.<br>

Un escaneo de de conexión TCP completo requiere que el escáner envíe un paquete adicional por escaneo, lo que aumenta la cantidad de ruido en la red y puede activar alarmas que un escaneo medio abierto no activaría. Las herramientas de seguridad y el sistema objetivo subyacente tienen más probabilidades de registrar una conexión TCP completa, y los sistemas de detección de intrusiones (IDS) tienen más probabilidades de activar alarmas en varias conexiones TCP desde el mismo host.<br>
__CONSEJO__: Nmap escanea solo los 1000 puertos más comunes para cada protocolo. Puede especificar puertos adicionales para escanear mediante la opción `-p`. Puede obtener información adicional sobre las especificaciones del puerto y el orden de escaneo en _https://nmap.org/book/man-port-specification.html_. Omar Santos también ha creado una hoja de referencia de Nmap que incluye todas las opciones y está disponible en su repositorio de GitHub en *https://github.com/The-Art-of-Hacking/h4cker/blob/master/cheat_sheets/NMAP_cheat_sheet.md*.<br>

### Escaneo UDP (`-sU`)
La mayoría de las veces, buscará puertos TCP, ya que así es como se conecta a la mayoría de los servicios que se ejecutan en los sistemas de destino. Sin embargo, puede encontrar algunos casos en los que deba buscar puertos UDP, por ejemplo, si está intentando enumerar un servidor DNS, SNMP o DHCP. Todos estos servicios utilizan UDP para la comunicación entre el cliente y el servidor. Para escanear puertos UDP, Nmap envía un paquete UDP a todos los puertos especificados en la configuración de la línea de comandos y espera noticias del objetivo. Si recibe un mensaje de puerto ICMP inaccesible de un destino, este puerto se marca como cerrado. Si no recibe respuesta del puerto UDP de destino, Nmap marca el puerto como abierto/filtrado.<br>

### Escaneo TCP FIN (`-sF`)
Hay momentos en los que un filtro de red o cortafuegos puede detectar un escaneo de sincronización. En tal caso, debe emplear un tipo diferente de paquete en un escaneo de puertos. Con el escaneo TCP FIN, se envía un paquete FIN a un puerto de destino. Si el puerto está realmente cerrado, el sistema devuelve un paquete RST. Si no recibe nada del puerto de destino, puede considerar el puerto abierto porque el comportamiento normal sería ignorar el paquete FIN.<br>

### Escaneo de detección de host (`-sn`)
Un escaneo de detección de host es uno de los tipos más comunes de escaneos utilizados para enumerar hosts en una red porque puede usar diferentes tipos de mensajes ICMP para determinar si un host está en línea y responde en una red.<br>
__NOTA__: El valor predeterminado para la opción de escaneo `-sn` es enviar un paquete de solicitud de eco ICMP al destino, un TCP SYN al puerto 443, un TCP ACK al puerto 80 y una solicitud de marca de tiempo ICMP. Esto está documentado en _https://nmap.org/book/man-host-discovery.html_. Si el objetivo responde al eco de ICMP o a los paquetes mencionados anteriormente, se considera activo.<br>
