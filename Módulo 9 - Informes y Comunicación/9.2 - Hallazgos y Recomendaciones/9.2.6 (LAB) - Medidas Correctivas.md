# 9.2.6 - Práctica de Laboratorio: Recomendar Medidas Correctivas en función de los Hallazgos

## Objetivos
En esta práctica de laboratorio se cumplirán los siguientes objetivos:<br>
+ Identificar y priorizar las vulnerabilidades encontradas en el servidor DVWA.
+ Investigar y recomendar estrategias de mitigación.<br>

## Trasfondo / Escenario
Su equipo de pruebas de penetración escaneó el servidor en 10.6.6.13 con Nikto y determinó que existen vulnerabilidades en el servidor. Es su responsabilidad investigar más a fondo los hallazgos y determinar qué recomendaciones de mitigación deben incluirse en el informe de prueba de penetración.

## Recursos Necesarios
+ Kali VM personalizada para el curso Ethical Hacker
+ Acceso a Internet<br>

### Parte 1: Identificar y priorizar las vulnerabilidades encontradas en el servidor DVWA
#
#### Paso 1: Escanee un host vulnerable con Nikto y cree un informe
Ejecute un análisis rápido del servidor DVWA con Nikto y envíe los resultados a un archivo HTM. Se descubrieron varias vulnerabilidades.<br>
```bash
    ┌──(kali㉿Kali)-[~]
    └─$ nikto -h 10.6.6.13 -o pentest.htm
```
Puede utilizar este informe para investigar las vulnerabilidades que se encontraron en el objetivo.<br>
#### Paso 2: Realice un análisis detallado con GVM para investigar más a fondo las vulnerabilidades del servidor
+ Inicie el tablero de GVM para escanear el servidor DVWA.<br>
```bash
    ┌──(kali㉿Kali)-[~]
    └─# sudo gvm-start
```
+ Cuando se abra el navegador Firefox, inicie sesión con el nombre de usuario `admin` y la contraseña `kali`.
+ Inicie una nueva tarea con el `Task Wizard` haciendo clic en `Scans` en la barra de menú y luego seleccionando `Task Wizard` en el ícono de varita mágica en la parte superior izquierda de la ventana de escaneo.
+ Introduzca la dirección IP `10.6.6.13` en el campo `IP Address` o `Host name`. Haga clic en `Start Scan`. El análisis puede demorar unos minutos; la barra de estado junto al nombre de análisis indica el porcentaje completado.<br>
#### Paso 3: Investigue los riesgos asociados con cada vulnerabilidad
+ Cuando finalice el escaneo de GVM, vaya al menú Scans y seleccione Reports. Debería ver el informe de su último análisis en la lista.
+ Haga clic en la entrada de fecha y hora de la tarea para ver el informe. Haga clic en la ficha Results para ver los resultados del análisis.
+ Haga clic en cada vulnerabilidad encontrada para mostrar información detallada sobre los riesgos asociados con la vulnerabilidad.
+ Abra el archivo de informe de análisis Nikto pentest.htm que se creó en el Paso 1.
+ Utilice los recursos de Internet para investigar más a fondo las vulnerabilidades que se descubrieron con Nikto y GVM.
+ Las vulnerabilidades de prioridad 1 deben corregirse de inmediato.
+ Las vulnerabilidades de prioridad 2 deben corregirse, pero son menos probables o más difíciles de aprovechar.

+ Las vulnerabilidades de prioridad 3 son de bajo riesgo y es poco probable que se aprovechen.

| Prioridad | Vulnerabilidad | Impacto | Gravedad |
|-----------|----------------|---------|----------|
| 2 | El encabezado anti-clickjacking X-Frame-Options no está presente | Potencialmente podría habilitar secuestro de clics | Medio
| 3 | El encabezado X-Content-Type-Options no está configurado | Puede hacer que los navegadores transformen contenido no ejecutable en contenido ejecutable | Baja |
| 2 | Se encontró la indexación de directorios | Es posible que la lista de contenido de directorios revele información potencialmente confidencial | Medio |
| 1 | Fin de vida útil del sistema operativo | No recibir actualizaciones de seguridad | Medio |
| 2 | Falta el atributo de cookie "HttpOnly" (HTTP) | Permite el acceso de JavaScript a una cookie, lo que permite el secuestro de sesiones | Medio |
| 1 | Transmisión de texto sin cifrar de información confidencial a través de HTTP | El atacante puede espiar o realizar un ataque intermediario | Medio |
| 3 | Marcas de tiempo TCP | Se puede calcular el tiempo de actividad del host remoto | Baja |
| 3 | Divulgación de información de respuesta de marca de tiempo de ICMP | Podría usarse para aprovechar servicios débiles basados en el tiempo | Baja |

### Parte 2: Investigación y recomendación de estrategias de mitigación
Al final de un proyecto de prueba de penetración, se crea un informe o una serie de informes para informar a las partes interesadas de los resultados de la prueba. Uno de los componentes principales en el informe son las correcciones sugeridas para mitigar o solucionar las vulnerabilidades identificadas.<br>

| Vulnerabilidad | Solución sugerida |
|----------------|-------------------|
| Fin de vida útil del sistema operativo | Actualizar a la versión compatible actual del sistema operativo y planifique un medio para mantener el dispositivo actualizado en el futuro |
| Indexación de directorios | Desactivar la función en el archivo de configuración del servidor web |
| Transmisión de texto sin cifrar a través de HTTP | Utilizar protocolos de cifrado como SSL/TLS o HTTPS para garantizar que los datos se cifren en tránsito |
| Falta el atributo de cookie "HttpOnly" | Etiquetar las cookies con el indicador HttpOnly que le indica al navegador que solo el servidor debe acceder a esta cookie en particular |
| X-Frame-Options no está presente | Enviar las opciones de X-Frame adecuadas en los encabezados de respuesta HTTP que indican al navegador que no permita el encuadre de otros dominios. Emplear código defensivo en la interfaz de usuario para garantizar que el fotograma actual sea la ventana del nivel más alto |
