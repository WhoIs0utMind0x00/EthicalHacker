# 6.7.5 - Mitigaciones de XSS
Las siguientes son reglas generales para prevenir ataques XSS según OWASP:<br>
- Utilice un sistema de plantillas con escape automático.
- Nunca inserte datos que no sean de confianza, excepto en ubicaciones permitidas.
- Utilice el escape HTML antes de insertar datos no confiables en el contenido de un HTML.
- Utilice el atributo de escape antes de insertar datos no confiable en los atributos comunes de un HTML.
- Utilice el escape de JavaScript antes de insertar datos no confiables en valores de datos de JavaScript.
- Utilice el escape CSS y valide estrictamente antes de insertar datos no confiables en valores de propiedad de estilo HTML.
- Utilice el escape de URL antes de insertar datos que no sean de confianza en los valores de los parámetros de URL HTML.
- Sanitice el marcado HTML con una biblioteca como ESAPI para proteger la aplicación subyacente.
- Evite el XSS basado en DOM siguiendo las recomendaciones de [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html).
- Utilice el indicador de cookie __HTTPOnly__.
- Implemente la política de seguridad de contenido.
- Utilice el encabezado de respuesta X-XSS-Protection.<br>

También debe convertir entradas no confiables en un formato seguro donde la entrada se muestre como datos para el usuario. Esto evita que la entrada se ejecute como código en el navegador. Para ello, realice la siguiente codificación de entidad HTML:<br>

- Convertir `&` a `&amp;`
- Convertir `<` a `&lt`
- Convertir `>` a `&gt`
- Convertir `"` a `&quot`
- Convertir `"` a `&#x27`
- Convertir `/` a `&#x2F;`

Los siguientes son procedimientos adicionales recomendados para prevenir ataques XSS:<br>
- Escape todos los caracteres (incluidos los espacios pero sin los caracteres alfanuméricos) con el formato de entidad HTML `&#xHH` (donde HH es un valor hexadecimal).
- Utilice solo la codificación de URL, no la URL completa o los fragmentos de ruta de una URL, para codificar los valores de los parámetros.
- Escape todos los caracteres (excepto los caracteres alfanuméricos), con el formato de escape Unicode ``\uXXXX`` (donde X es un entero).
- El escape CSS admite `\XX` y `\XXXXXX`, así que agregue un espacio después del escape CSS o use la cantidad total de escape CSS posible rellenando el valor con ceros.
- Eduque a los usuarios sobre la navegación segura para reducir el riesgo de ser víctimas de ataques XSS.<br>
Los controles XSS ahora están disponibles en los navegadores web modernos.<br>